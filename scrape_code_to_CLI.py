from selenium import webdriver
from selenium.webdriver.chrome.options import Options
from selenium.webdriver.common.keys import Keys
import re

def page_source_get():
    global page_source
    page_source = browser.page_source

def cleanhtml(raw_html):
  cleanr = re.compile('<.*?>')
  cleantext = re.sub(cleanr, '', raw_html)
  return cleantext

def doubleClick():
    browser.find_element_by_id("NextButton").click()
    browser.find_element_by_id("NextButton").click()
    
def mainSequence():
    browser.get(start_url)

    browser.find_element_by_name("NextButton").click()

    #Survey code and input time
    browser.find_element_by_name("SurveyCode").send_keys(str(survey_code))

    browser.find_element_by_name("InputHour").click()
    browser.find_element_by_name("InputHour").send_keys(Keys.DOWN)

    browser.find_element_by_name("InputMinute").click()
    browser.find_element_by_name("InputMinute").send_keys(Keys.DOWN)

    browser.find_element_by_name("InputMeridian").click()
    browser.find_element_by_name("InputMeridian").send_keys(Keys.DOWN)

    browser.find_element_by_name("NextButton").click()

    #Order Type
    doubleClick()

    #Num ppl in party
    doubleClick()

    #Satisfaction Overall
    doubleClick()

    #Satisfaction with...
    doubleClick()

    #Satisfaction with... temperature+value
    doubleClick()

    #Satisfaction with... fries,burger
    doubleClick()

    #problems with experience
    doubleClick()

    #Recommend
    doubleClick()

    #HJ popular, favourite
    doubleClick()

    #Design of HJs
    doubleClick()

    #what main item
    doubleClick()

    #what side items... does not allow double click
    doubleClick()

    #times ordered
    doubleClick()

    #reason visit
    doubleClick()

    #fast food been most
    doubleClick()

    #gender age
    doubleClick()

    #zip code
    browser.find_element_by_id("NextButton").click()
    




print("Initialising Window Settings ...", end =" ")
chrome_options = Options()
chrome_options.add_argument("--disable-extensions")
chrome_options.add_argument("--disable-gpu")
chrome_options.add_argument("--headless")
chrome_options.add_argument('--ignore-certificate-errors')
chrome_options.add_argument('--log-level=3')
browser = webdriver.Chrome(options=chrome_options)
print("Success")


start_url = "https://www.myhjexperience.com/"

while True:
    try:
        inp = input("Enter Code: ")
        if inp=='exit':
            break
        survey_code = inp
        mainSequence()
    except:
        element=browser.find_element_by_class_name("ValCode").text
        li = str(element).split(" ")
        print(str(survey_code))
        print(li[2])








